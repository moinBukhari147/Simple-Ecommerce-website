{% extends 'shop/basic.html' %}
{%block title%}Shop{% endblock %}
{% load static %}


    {%block css%}
    <style>


      .myCorosalSetting
      {
        background: green;
        width: 100%;
        height: 400px;
        margin-top: 20px;
      }
      .carousel-item img
      {
        width: 100%;
        height: 400px;
        object-fit: cover;
        filter: brightness(60%);
      }
      .carousel-indicators
      {
        height: 10px;
        bottom: -25px;
      }
      .carousel-indicators .active
      {
        background-color: #36454F;
      }

.carousel_custom_css
{
display: felx;
justify-content: space-between;
}
.carousel_custom_css card
{
  flex: 1;
}
#demo .carousel-item img
{
  height: 300px;
filter: brightness(80%);
}

.custom_container_setting
{
  position: relative;
}
.custom_container_setting .custom_corosal_button_setting
{
  top: calc(50% - 20px);

  width: 40px;
  height: 40px;
}
.custom_container_setting .carousel-control-prev {
  left: 10px;
}
.custom_container_setting .carousel-control-prev:hover
{
  opacity: 1;
}

.custom_container_setting .carousel-control-next{
  right: -15px;
  opacity: .7;
}
.custom_container_setting .carousel-control-next:hover
{
  filter: brightness(30%);
}
</style>
{% endblock %}


{%block body%}

  <!--        carousel indicators starts from here-->

 <div class="container">
   <div id="carouselExampleCaptions" class="carousel slide myCorosalSetting" data-bs-ride="carousel">
      <div class="carousel-indicators mt-5">
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4" aria-label="Slide 5"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="5" aria-label="Slide 0"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="{% static 'shop/product1.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>SIMPLE</h5>
            <p>You can have anything you want in life if you dress for it.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="{% static 'shop/product2.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>SIMPLE</h5>
            <p>Clothes mean nothing until someone lives in them.</p>
            
          </div>
        </div>
        <div class="carousel-item">
          <img src="{% static 'shop/product3.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">

            <h5>SIMPLE</h5>
            <p>Style is a way to say who you are without having to speak.</p>
            
          </div>
        </div>
        <div class="carousel-item">
          <img src="{% static 'shop/product4.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>We don't sell</h5>
          
          </div>
        </div>
        <div class="carousel-item">
          <img src="{% static 'shop/product5.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>We buy your trust.</h5>
          
          </div>
        </div>
        <div class="carousel-item">
          <img src="{% static 'shop/product6.webp' %}" class="d-block w-100" alt="...">
          <div class="carousel-caption d-none d-md-block">
            <h5>We buy your interest.</h5>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
  </div>
 </div>


<!--Corosal for products-->
{%if no_product%}
  <div class="container">
  <p class="col-8 mx-auto" style="font-size: 30px; color:rgb(120, 123, 126); text-align:center;">Oops..... the item you are looking for is not found.....<br>Try another search</p>
  </div>
  {%else%}
  {% for products,num_of_slides, range in categorised_product %}
  <div class="container custom_container_setting">

    <h2 class="mt-5 ms-2">{{ products.0.product_category }}</h2>
    <div id="demo{{forloop.counter}}" class="carousel slide my-3" data-ride="carousel">
        <div class="carousel-indicators">
          <button type="button" data-bs-target="#demo{{forloop.counter}}" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>

          {% for i in range %}
            <button type="button" data-bs-target="#demo{{forloop.parentloop.counter}}" data-bs-slide-to="{{i}}" aria-label="Slide {{i|add:1}}"></button>
          {% endfor %}
        </div>
      <div class="carousel-inner">
        <div class="carousel-item carousel_custom_css active">
          <div class="row">

            {%for i in products%}

            <div class="col-xs-3 col-sm-3 col-md-3">
              <div class="card" style="width: 18rem;">
                <img src="/media/{{i.product_image}}" class="card-img-top" alt="...">
                <div class="card-body">
                  <h5 class="card-title" id="namepr{{i.id}}" >{{i.product_name}}</h5>
                  <p class="card-text">{{i.product_desc|slice:":35"}}</p>
                  <p class="card-text">Rs: {{i.product_price}}</p>
                  <span id="divpr{{i.id}}" class="divpr">
                    <button id="pr{{i.id}}" href="#" class="ms-3 cart btn btn-primary">Add To Cart</button>
                  </span>
                  <a href="/shop/product/{{i.id}}"><button id="pv{{i.id}}" href="#" class="ms-3 cart btn btn-primary">Shop Now</button></a>
                </div>
              </div>
            </div>
            {% if forloop.counter|divisibleby:4 and forloop.counter > 0 and not forloop.last%}
                </div>
              </div>
              <div class="carousel-item carousel_custom_css">
                <div class="row">
                  {% endif %}
                  {% endfor %}
          </div>
        </div>
      </div>
    </div>
  {%if num_of_slides > 1%}
      <button class="carousel-control-prev custom_corosal_button_setting" type="button" data-bs-target="#demo{{forloop.counter}}" data-bs-slide="prev">
          <span class="carousel-control-prev-icon custom_control_setting" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next custom_corosal_button_setting" type="button" data-bs-target="#demo{{forloop.counter}}" data-bs-slide="next">
          <span class="carousel-control-next-icon custom_control_setting" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
  {% endif %}
  </div>
  {% endfor %}
{% endif %}
{% endblock %}
{% block js%}
  <script>
    document.querySelector('.shop').classList.add('active')
    updateAddToCart(cart);
    function updateAddToCart(cart)
{
  for (var item in cart)
  {
    document.getElementById('div'+item).innerHTML = "<button id='minus"+item+"' class ='btn btn-primary minus'>-</button>" + "<span id='val"+item+"'>"+cart[item][0]+"</span> <button class='btn btn-primary plus' id='plus"+item+"'>+</button>";
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  document.getElementById('cartvalue').innerHTML = (Object.keys(cart).length);
  
}

$('.cart').click(function(){
    var idstr = this.id.toString();
    if ( cart[idstr] == undefined )
    {
      qty = 1;
      itemName = document.getElementById('name' + idstr).innerHTML;
      cart[idstr] = [qty,itemName];
      updateAddToCart(cart);
    }
  });

  //Changing the value of cart with + and -  button when they clicked
$('.divpr').on("click","button.plus",function(){
  a = this.id.slice(4,);
  cart[a][0]+=1;
  document.getElementById('val'+ a).innerHTML = cart[a][0];
  updateAddToCart(cart);
});
$('.divpr').on("click","button.minus",function(){
  a = this.id.slice(5,);
  cart[a][0]-=1;
  cart[a][0]=Math.max(0,cart[a][0]);
  document.getElementById('val' + a).innerHTML = cart[a][0];
  updateAddToCart(cart);
});

  </script>
{% endblock %}

